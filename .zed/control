#!/bin/bash

case $ZED_CONTROL in
	nsenter)
PID=$($DOCKER_CMD inspect --format {{.State.Pid}} $CONTAINER_NAME)
echo "Entering namespace for $CONTAINER_NAME (PID: $PID)"
CMD=nsenter \
 --target $PID \
 --mount \
 --uts \
 --ipc \
 --net \
 --pid \
 $*
	;;
	ssh)
SRV_PORT=`$DOCKER_CMD port $CONTAINER_NAME 22 | cut -d : -f 2`
echo "Remoting into $CONTAINER_NAME - $SRV_PORT"
CMD=ssh \
 -t \
 -o "LogLevel QUIET" \
 -o "StrictHostKeyChecking no" \
 -o "UserKnownHostsFile /dev/null" \
 -p $SRV_PORT \
 comfreeze@localhost
	;;
esac;

echo $CMD $*
